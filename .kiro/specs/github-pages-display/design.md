# 设计文档：GitHub 数据展示页面

## 概述

本设计文档描述了为 GitHub 整理工具创建的 Web 展示页面的架构和实现方案。该页面将在 GitHub Pages 上托管，通过 GitHub Actions 自动化工作流定期更新数据，为用户提供一个现代化的 Stars 和 Repositories 数据展示平台。

## 架构

### 整体架构

```
┌─────────────────────────────────────────────────────────────┐
│                    GitHub Pages 静态网站                      │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  ┌──────────────────────────────────────────────────────┐   │
│  │              index.html (主页面)                      │   │
│  │  ┌────────────────────────────────────────────────┐  │   │
│  │  │  页签导航 (Stars | Repositories)               │  │   │
│  │  └────────────────────────────────────────────────┘  │   │
│  │  ┌────────────────────────────────────────────────┐  │   │
│  │  │  Stars 展示区域                                 │  │   │
│  │  │  - 统计概览卡片                                 │  │   │
│  │  │  - 热度排行列表                                 │  │   │
│  │  │  - 语言分类统计                                 │  │   │
│  │  │  - 主题分类统计                                 │  │   │
│  │  └────────────────────────────────────────────────┘  │   │
│  │  ┌────────────────────────────────────────────────┐  │   │
│  │  │  Repositories 展示区域                          │  │   │
│  │  │  - 统计概览卡片                                 │  │   │
│  │  │  - 热度排行列表                                 │  │   │
│  │  │  - 语言分类统计                                 │  │   │
│  │  │  - 主题分类统计                                 │  │   │
│  │  └────────────────────────────────────────────────┘  │   │
│  └──────────────────────────────────────────────────────┘   │
│                                                               │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  assets/                                             │   │
│  │  ├── css/style.css (样式表)                          │   │
│  │  ├── js/app.js (主应用逻辑)                          │   │
│  │  └── data/ (数据文件)                                │   │
│  │      ├── github_stars.json                           │   │
│  │      └── github_repos.json                           │   │
│  └──────────────────────────────────────────────────────┘   │
│                                                               │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│              GitHub Actions 自动化工作流                      │
├─────────────────────────────────────────────────────────────┤
│                                                               │
│  触发条件：代码提交到主分支                                   │
│                                                               │
│  步骤 1: 运行 organize_github_stars.py                       │
│  ↓                                                            │
│  步骤 2: 运行 organize_github_repos.py                       │
│  ↓                                                            │
│  步骤 3: 生成 JSON 数据文件到 assets/data/                   │
│  ↓                                                            │
│  步骤 4: 提交更新到仓库                                       │
│  ↓                                                            │
│  步骤 5: GitHub Pages 自动部署                               │
│                                                               │
└─────────────────────────────────────────────────────────────┘
```

### 技术栈

- **前端框架**: 原生 HTML5 + CSS3 + JavaScript (无框架依赖)
- **样式框架**: CSS Grid + Flexbox (响应式设计)
- **数据格式**: JSON
- **部署平台**: GitHub Pages
- **自动化工具**: GitHub Actions
- **数据源**: Python 脚本 (organize_github_stars.py, organize_github_repos.py)

## 组件和接口

### 前端组件

#### 1. 页面结构组件

**TabNavigation (页签导航)**
- 职责：管理 Stars 和 Repositories 两个页签的切换
- 属性：
  - `activeTab`: 当前活跃页签 ('stars' | 'repos')
  - `tabs`: 页签列表
- 方法：
  - `switchTab(tabName)`: 切换页签
  - `saveTabPreference()`: 保存用户选择到 localStorage
  - `loadTabPreference()`: 从 localStorage 加载用户选择

**LoadingIndicator (加载指示器)**
- 职责：显示数据加载状态
- 属性：
  - `isLoading`: 是否正在加载
  - `message`: 加载提示信息
- 方法：
  - `show()`: 显示加载指示器
  - `hide()`: 隐藏加载指示器

**ErrorDisplay (错误显示)**
- 职责：显示错误信息
- 属性：
  - `error`: 错误对象
  - `message`: 错误提示信息
- 方法：
  - `show(error)`: 显示错误
  - `hide()`: 隐藏错误

#### 2. 数据展示组件

**StatisticsCard (统计卡片)**
- 职责：显示统计数据
- 属性：
  - `title`: 卡片标题
  - `value`: 统计值
  - `unit`: 单位
  - `icon`: 图标
- 方法：
  - `render()`: 渲染卡片

**ProjectList (项目列表)**
- 职责：显示项目列表
- 属性：
  - `projects`: 项目数组
  - `columns`: 显示的列
  - `sortBy`: 排序字段
- 方法：
  - `render()`: 渲染列表
  - `sort(field)`: 按字段排序
  - `filter(criteria)`: 按条件过滤

**CategoryStatistics (分类统计)**
- 职责：显示分类统计信息
- 属性：
  - `categories`: 分类数据
  - `type`: 分类类型 ('language' | 'topic')
- 方法：
  - `render()`: 渲染分类统计

#### 3. 数据管理组件

**DataLoader (数据加载器)**
- 职责：从 JSON 文件加载数据
- 方法：
  - `loadStars()`: 加载 Stars 数据
  - `loadRepos()`: 加载 Repositories 数据
  - `handleError(error)`: 处理加载错误

**DataProcessor (数据处理器)**
- 职责：处理和转换数据
- 方法：
  - `sortByStars(projects)`: 按 Stars 数排序
  - `groupByLanguage(projects)`: 按语言分组
  - `groupByTopic(projects)`: 按主题分组
  - `calculateStatistics(projects)`: 计算统计数据

### 数据流

```
用户访问页面
    ↓
页面加载 (DOMContentLoaded)
    ↓
显示加载指示器
    ↓
DataLoader 加载 JSON 数据
    ↓
DataProcessor 处理数据
    ↓
隐藏加载指示器
    ↓
渲染页面内容
    ↓
用户交互 (切换页签、点击链接等)
```

## 数据模型

### Stars 数据结构

```json
{
  "username": "string",
  "generated_at": "ISO 8601 datetime",
  "total": "number",
  "by_language": {
    "language_name": {
      "count": "number",
      "percentage": "number"
    }
  },
  "by_topic": {
    "topic_name": {
      "count": "number",
      "percentage": "number"
    }
  },
  "all_projects": [
    {
      "name": "string",
      "html_url": "string",
      "description": "string",
      "stargazers_count": "number",
      "language": "string",
      "topics": ["string"],
      "updated_at": "ISO 8601 datetime"
    }
  ]
}
```

### Repositories 数据结构

```json
{
  "username": "string",
  "generated_at": "ISO 8601 datetime",
  "total": "number",
  "average_stars": "number",
  "average_forks": "number",
  "by_language": {
    "language_name": {
      "count": "number",
      "percentage": "number"
    }
  },
  "by_topic": {
    "topic_name": {
      "count": "number",
      "percentage": "number"
    }
  },
  "all_projects": [
    {
      "name": "string",
      "html_url": "string",
      "description": "string",
      "stargazers_count": "number",
      "forks_count": "number",
      "language": "string",
      "topics": ["string"],
      "updated_at": "ISO 8601 datetime",
      "fork": "boolean",
      "private": "boolean"
    }
  ]
}
```

## 页面布局

### Stars 页面布局

```
┌─────────────────────────────────────────────────────────┐
│  Stars 页签 (活跃)  │  Repositories 页签                │
├─────────────────────────────────────────────────────────┤
│                                                           │
│  统计概览                                                 │
│  ┌──────────┬──────────┬──────────┐                      │
│  │ 总数     │ 语言数   │ 主题数   │                      │
│  │ 123      │ 25       │ 45       │                      │
│  └──────────┴──────────┴──────────┘                      │
│                                                           │
│  热度排行                                                 │
│  ┌─────────────────────────────────────────────────┐    │
│  │ 项目名称  │ Stars │ 语言      │ 链接              │    │
│  ├─────────────────────────────────────────────────┤    │
│  │ project1  │ 5000  │ Python    │ [链接]            │    │
│  │ project2  │ 4500  │ JavaScript│ [链接]            │    │
│  │ ...       │ ...   │ ...       │ ...               │    │
│  └─────────────────────────────────────────────────┘    │
│                                                           │
│  语言分类                                                 │
│  ┌──────────┬──────────┬──────────┐                      │
│  │ Python   │ JavaScript│ Go      │                      │
│  │ 45 (36%) │ 30 (24%) │ 20 (16%)│                      │
│  └──────────┴──────────┴──────────┘                      │
│                                                           │
│  主题分类                                                 │
│  ┌──────────┬──────────┬──────────┐                      │
│  │ AI/ML    │ Web      │ DevOps   │                      │
│  │ 30 (24%) │ 25 (20%) │ 15 (12%)│                      │
│  └──────────┴──────────┴──────────┘                      │
│                                                           │
└─────────────────────────────────────────────────────────┘
```

### Repositories 页面布局

类似 Stars 页面，但显示额外的 Forks 数和最后更新时间。

## 样式设计

### 配色方案

- **主色**: #0366d6 (GitHub 蓝)
- **辅助色**: #6f42c1 (紫色)
- **背景色**: #ffffff (白色)
- **文本色**: #24292e (深灰)
- **边框色**: #e1e4e8 (浅灰)
- **成功色**: #28a745 (绿色)
- **警告色**: #ffc107 (黄色)
- **错误色**: #dc3545 (红色)

### 响应式断点

- **移动设备**: < 768px
- **平板设备**: 768px - 1024px
- **桌面设备**: > 1024px

### 字体

- **标题**: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif
- **正文**: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif

## 正确性属性

一个属性是一个特征或行为，应该在系统的所有有效执行中保持真实——本质上是关于系统应该做什么的正式陈述。属性充当人类可读规范和机器可验证正确性保证之间的桥梁。

### 属性 1：热度排行排序正确性

*对于任何* Stars 或 Repositories 项目列表，按 Stars 数排序后，列表中任意两个相邻项目的 Stars 数应满足递减关系（前项 >= 后项）。

**验证需求**: 需求 1.2, 2.2

### 属性 2：项目信息完整性

*对于任何* 渲染的项目卡片，输出应包含所有必需字段：名称、链接、描述、Stars 数和编程语言（Stars 页面）或名称、链接、描述、Stars 数、Forks 数、编程语言和最后更新时间（Repositories 页面）。

**验证需求**: 需求 1.3, 2.3

### 属性 3：语言分类准确性

*对于任何* 项目列表，按编程语言分组后，每个分组中的所有项目的语言字段应与分组名称相同。

**验证需求**: 需求 1.4, 2.4

### 属性 4：主题分类准确性

*对于任何* 项目列表，按主题分组后，每个分组中的所有项目的主题列表应包含该分组名称。

**验证需求**: 需求 1.5, 2.5

### 属性 5：页签切换内容正确性

*对于任何* 页签切换操作，切换到 Stars 页签后应显示 Stars 内容，切换到 Repositories 页签后应显示 Repositories 内容。

**验证需求**: 需求 3.2, 3.3

### 属性 6：页签偏好持久化

*对于任何* 用户选择的页签，刷新页面后应恢复到用户上次选择的页签。

**验证需求**: 需求 3.6

### 属性 7：JSON 数据加载正确性

*对于任何* 有效的 JSON 数据文件，加载后应能正确解析并转换为应用内部数据结构。

**验证需求**: 需求 5.1

### 属性 8：页签切换无需重新加载

*对于任何* 已加载的数据，切换页签时应立即显示对应内容，无需重新加载数据文件。

**验证需求**: 需求 5.4

### 属性 9：JSON 数据文件生成正确性

*对于任何* 从 Python 脚本生成的 JSON 数据文件，文件应包含所有必需字段且格式有效。

**验证需求**: 需求 4.4

## 错误处理

### 数据加载错误

- **网络错误**: 显示"无法加载数据，请检查网络连接"
- **JSON 解析错误**: 显示"数据格式错误，请稍后重试"
- **文件不存在**: 显示"数据文件不存在，请运行数据抓取脚本"

### 用户交互错误

- **页签切换失败**: 保持当前页签，显示错误提示
- **链接打开失败**: 显示"无法打开链接"

## 测试策略

### 单元测试

1. **数据处理函数测试**
   - 测试排序函数是否正确排序
   - 测试分组函数是否正确分组
   - 测试统计函数是否正确计算

2. **组件渲染测试**
   - 测试统计卡片是否正确渲染
   - 测试项目列表是否正确渲染
   - 测试分类统计是否正确渲染

3. **数据加载测试**
   - 测试 JSON 加载是否成功
   - 测试错误处理是否正确
   - 测试数据验证是否正确

### 属性测试

1. **属性 1 测试**: 生成随机项目列表，排序后验证递减关系
2. **属性 2 测试**: 生成随机项目，渲染后验证所有必需字段存在
3. **属性 3 测试**: 生成随机项目列表，分组后验证语言一致性
4. **属性 4 测试**: 生成随机项目列表，分组后验证主题包含关系
5. **属性 5 测试**: 模拟页签切换，验证内容正确性
6. **属性 6 测试**: 保存页签选择，刷新后验证恢复
7. **属性 7 测试**: 加载有效 JSON，验证解析正确性
8. **属性 8 测试**: 加载数据后切换页签，验证无需重新加载
9. **属性 9 测试**: 验证生成的 JSON 文件格式和内容

### 集成测试

1. **完整工作流测试**
   - 加载数据 → 渲染页面 → 切换页签 → 验证内容

2. **错误恢复测试**
   - 模拟加载失败 → 显示错误 → 重试成功

3. **响应式设计测试**
   - 在不同屏幕尺寸下验证布局正确性

## 部署和维护

### 文件结构

```
.
├── index.html                    # 主页面
├── assets/
│   ├── css/
│   │   └── style.css            # 样式表
│   ├── js/
│   │   └── app.js               # 应用逻辑
│   └── data/
│       ├── github_stars.json    # Stars 数据
│       └── github_repos.json    # Repos 数据
├── .github/
│   └── workflows/
│       └── update-data.yml      # GitHub Actions 工作流
└── README.md                     # 项目说明
```

### GitHub Pages 配置

- 源分支: main
- 部署目录: / (根目录)
- 自动部署: 启用

### 数据更新流程

1. 代码提交到 main 分支
2. GitHub Actions 触发工作流
3. 运行 Python 脚本抓取数据
4. 生成 JSON 文件到 assets/data/
5. 提交更新到仓库
6. GitHub Pages 自动部署

